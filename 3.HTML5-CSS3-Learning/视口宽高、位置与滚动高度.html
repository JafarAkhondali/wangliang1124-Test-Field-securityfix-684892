<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>视口宽高、位置与滚动高度</title>
        <style>
            * {
                padding: 0;
                margin: 0;
            }

            .wrapper {
                padding: 0 100px;
                overflow: hidden;
            }
        </style>
    </head>
    <body>
        <div class="wrapper" style="height: 2000px">
            <div id="writeroot" style="padding: 20px 0; line-height: 1.5"></div>
            <div>offsetWidth = clientWidth + scrollbarWidth + borderWidth</div>
            <div
                id="content-wrapper"
                style="
                    width: 800px;
                    height: 500px;
                    padding: 20px;
                    border-style: dashed;
                    border-width: 10px;
                    border-color: #ccc;
                    overflow: scroll;
                "
            >
                <div id="content">
                    <p>
                        The CSS box model is rather complicated, particularly when it comes to scrolling content. While
                        the browser uses the values from your CSS to draw boxes, determining all the dimensions using JS
                        is not straight-forward if you only have the CSS.
                    </p>

                    <p>
                        That's why each element has six DOM properties for your convenience: <code>offsetWidth</code>,
                        <code>offsetHeight</code>, <code>clientWidth</code>, <code>clientHeight</code>,
                        <code>scrollWidth</code> and <code>scrollHeight</code>. These are read-only attributes
                        representing the current visual layout, and all of them are <em>integers</em> (thus possibly
                        subject to rounding errors).
                    </p>

                    <p>Let's go through them in detail:</p>

                    <ul>
                        <li>
                            <code>offsetWidth</code>, <code>offsetHeight</code>: The size of the visual box incuding all
                            borders. Can be calculated by adding <code>width</code>/<code>height</code> and paddings and
                            borders, if the element has <code>display: block</code>
                        </li>
                        <li>
                            <code>clientWidth</code>, <code>clientHeight</code>: The visual portion of the box content,
                            not including borders or scroll bars , but includes padding . Can not be calculated directly
                            from CSS, depends on the system's scroll bar size.
                        </li>
                        <li>
                            <code>scrollWidth</code>, <code>scrollHeight</code>: The size of all of the box's content,
                            including the parts that are currently hidden outside the scrolling area. Can not be
                            calculated directly from CSS, depends on the content.
                        </li>
                    </ul>

                    <p><img src="https://i.stack.imgur.com/5AAyW.png" alt="CSS2 Box Model" /></p>

                    <hr />

                    <p>
                        Since <code>offsetWidth</code> takes the scroll bar width into account, we can use it to
                        calculate the scroll bar width via the formula
                    </p>

                    <pre
                        class="lang-html s-code-block"
                    ><code class="hljs language-xml">scrollbarWidth = offsetWidth - clientWidth - getComputedStyle().borderLeftWidth - getComputedStyle().borderRightWidth
                    </code></pre>

                    <p>
                        Unfortunately, we may get rounding errors, since <code>offsetWidth</code> and
                        <code>clientWidth</code> are always integers, while the actual sizes may be fractional with zoom
                        levels other than 1.
                    </p>

                    <p>Note that this</p>

                    <pre
                        class="lang-html s-code-block"
                    ><code class="hljs language-xml">scrollbarWidth = getComputedStyle().width + getComputedStyle().paddingLeft + getComputedStyle().paddingRight - clientWidth
                    </code></pre>

                    <p>
                        does <strong>not</strong> work reliably in Chrome, since Chrome returns <code>width</code> with
                        scrollbar already substracted. (Also, Chrome renders paddingBottom to the bottom of the scroll
                        content, while other browsers don't)
                    </p>
                </div>
            </div>
        </div>
        <script>
            window.addEventListener("load", function () {
                var text1 = document.querySelector("#content-wrapper");
                console.log(text1.getClientRects());
                console.log(text1.getBoundingClientRect());

                var supportPageOffset = window.pageXOffset !== "undefined";
                var isCSS1Compat = document.compatMode === "CSS1Compat";

                var x = supportPageOffset
                    ? window.pageXOffset
                    : isCSS1Compat
                    ? document.documentElement.scrollLeft
                    : document.body.scrollLeft;
                var y = supportPageOffset
                    ? window.pageYOffset
                    : isCSS1Compat
                    ? document.documentElement.scrollTop
                    : document.body.scrollTop;
                var z = window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft;
                console.log(x, y, z);
            });
        </script>
    </body>
    <script>
        var strings = "";
        strings += "screen.width/height = " + screen.width + " / " + screen.height;
        strings += "<br>";
        strings +=
            "documentElement.offsetWidth/offsetHeight = " +
            document.documentElement.offsetWidth +
            " / " +
            document.documentElement.offsetHeight;
        strings += "<br>";
        strings +=
            "documentElement.client = " +
            document.documentElement.clientWidth +
            " / " +
            document.documentElement.clientHeight;
        strings += "<br>";
        strings += "window.innerWidth/Height = " + window.innerWidth + " / " + window.innerHeight;
        strings += "<br>";
        strings += "window.innerHeight = " + window.innerHeight;
        strings += "<br>";

        var wrapper = document.getElementById("content-wrapper");
        strings += " wrapper.clientWidth/clientHeight = " + wrapper.clientWidth + " / " + wrapper.clientHeight;
        strings += "<br>";
        strings += " wrapper.offsetWidth/offsetHeight = " + wrapper.offsetWidth + " / " + wrapper.offsetHeight;
        strings += "<br>";
        strings += " wrapper.scrollWidth/scrollHeight = " + wrapper.scrollWidth + " / " + wrapper.scrollHeight;
        strings += "<br>";

        var content = document.getElementById("content");
        strings += " content.clientWidth/clientHeight = " + content.clientWidth + " / " + content.clientHeight;
        strings += "<br>";
        strings += " content.offsetWidth/offsetHeight = " + content.offsetWidth + " / " + content.offsetHeight;
        strings += "<br>";
        strings += " content.scrollWidth/scrollHeight = " + content.scrollWidth + " / " + content.scrollHeight;
        strings += "<br>";

        var writeroot = document.getElementById("writeroot");

        writeroot.innerHTML = strings;
    </script>
</html>
